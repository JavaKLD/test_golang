# Оглавление

- [Создание базы данных](#создание-базы-данных)
- [Используемые технологии](#используемые-технологии)
- [Структура проекта](#структура-проекта)
- [API](#api)

# Основные моменты 

1. После сборки контейнера, для входа в бд 
```    
docker exec -it <контейнер> mysql -u root -p strong_password (в docker-compose прописан)
```
2. Для автоматизации все команды подписаны в makefile (надеюсь все запустится =) )
3. Для интеграционных тестов поздно понял, что за моки нужно давать по рукам, хотел исправить, но не успел, зато обновил миграции
4. Пытался код максимально в порядок привести 
5. Еще так и не понял почему у меня вылезает ошибка в докер контейнере миграции, нулевой байт, не понял почему goose не может обработать этот файл
6. Так вроде все прописал основное, надеюсь эта шайтан машина будет работать исправно ))

## Создание базы данных

1. Вам потребуется создать базу данных для приложения. Используйте параметры, указанные в .env файле.

2. Настройка .env файла
В корневой директории проекта создайте файл .env и укажите в нем следующие переменные:

```env
DB_USER=root
DB_PASSWORD=41ddsg4mM!
DB_HOST=localhost
DB_PORT=3306
DB_NAME=dolittle

NEXT_TAKING_PERIOD=2h
```

Параметры для подключения к базе данных:

- **DB_USER**: имя пользователя для подключения к базе данных.
- **DB_PASSWORD**: пароль для пользователя.
- **DB_HOST**: хост базы данных.
- **DB_PORT**: порт для подключения (по умолчанию для MySQL —3306).
- **DB_NAME**: имя базы данных, которая будет использоваться впроекте.

Параметр NEXT_TAKING_PERIOD указывает период времени, в течении которого нужно принять лекарства.

## Используемые технологии


В данном проекте использованы следующие технологии:
1. *Go (Golang)*

Основной язык программирования, используемый для разработки серверной части приложения. 

2. *Echo*

Фреймворк для разработки веб-приложений на Go. Echo является быстрым и минималистичным фреймворком, который предоставляет удобные инструменты для создания REST API, маршрутизации и обработки запросов.

3. *GORM*

ORM (Object-Relational Mapping) библиотека для Go, которая используется для работы с базой данных. GORM позволяет работать с данными в базе данных через Go структуры и облегчает создание, чтение, обновление и удаление данных.

4. MySQL

Реляционная система управления базами данных, используемая для хранения данных о расписаниях и пользователях.

## Структура проекта


```bash
.
├── cmd
│   └── appname
│       └── main.go
├── coverage.out
├── database
│   └── migrations
│       └── 001_create_schedule_table.sql
├── docker-compose.yml
├── go.mod
├── go.sum
├── internal
│   ├── config
│   │   └── period_config.go
│   ├── domain
│   │   ├── models
│   │   │   └── schedule_model.go
│   │   ├── repos
│   │   │   └── schedule_repo.go
│   │   └── services
│   │       └── schedule_service.go
│   ├── server
│   │   ├── grpc_controller.go
│   │   ├── rest_controller.go
│   │   └── routers.go
│   └── utils
│       ├── next_takings.go
│       └── round_time.go
├── Makefile
├── openapi
├── pkg
│   ├── connectors
│   │   ├── logger.go
│   │   └── mysql.go
│   └── middleware
│       ├── grpc_logger.go
│       ├── grpc_masker.go
│       ├── rest_logger.go
│       └── rest_masker.go
├── proto
│   ├── schedule_grpc.pb.go
│   ├── schedule.pb.go
│   └── schedule.proto
└── tests
    ├── integration_test.go
    ├── next_takings_negative_test.go
    ├── next_takings_pozitive_test.go
    └── test_repo.go

```


# API

## GET /schedules?user_id={user_id}

Получает список идентификаторов существующих расписаний для указанного пользователя.

**Параметры запроса:**

    user_id (uint): Идентификатор пользователя.

**Ответ:**

Возвращает массив идентификаторов расписаний.


## GET /schedule?user_id={user_id}&schedule_id={schedule_id}

Получает данные о выбранном расписании с рассчитанным графиком приёмов на день.
Параметры запроса:

    user_id (uint): Идентификатор пользователя.
    schedule_id (uint): Идентификатор расписания.

**Ответ:**

Возвращает данные о расписании и расписание приёмов на день.


## GET /next_takings?user_id={user_id}
    
Получает данные о лекарствах, которые необходимо принять в ближайший период времени (например, в ближайший час).
Параметры запроса:

    user_id (uint): Идентификатор пользователя.

**Ответ:**

Возвращает данные о таблетках, которые нужно принять в ближайший период (название лекарства и во сколько нужно принять таблетки исходя из периода).
